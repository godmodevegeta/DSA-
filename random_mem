from guppy import hpy
import gc

h = hpy()

gc.collect()

# Capture the first heap snapshot
heap1 = h.heap()

gc.collect()

# Capture the second heap snapshot
heap2 = h.heap()

# Compute the difference between the two heaps
heap_diff = heap2 - heap1

module_stats = {}
for obj in heap_diff:
    module_name = obj.__class__.__module__
    if module_name not in module_stats:
        module_stats[module_name] = 0
    module_stats[module_name] += obj.size

for module_name, size in module_stats.items():
    print(f"Module: {module_name}, Size Difference: {size}")
